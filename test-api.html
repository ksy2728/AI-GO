<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e293b;
            color: #f1f5f9;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        pre {
            background: #0f172a;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #334155;
        }
        .success {
            color: #10b981;
        }
        .error {
            color: #ef4444;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #2563eb;
        }
        h2 {
            color: #60a5fa;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” AI Server API í…ŒìŠ¤íŠ¸</h1>
        
        <div>
            <button onclick="testAPI('models')">ëª¨ë¸ API í…ŒìŠ¤íŠ¸</button>
            <button onclick="testAPI('pricing')">ê°€ê²© API í…ŒìŠ¤íŠ¸</button>
            <button onclick="testAPI('status')">ìƒíƒœ API í…ŒìŠ¤íŠ¸</button>
            <button onclick="testAPI('scheduler')">ìŠ¤ì¼€ì¤„ëŸ¬ API í…ŒìŠ¤íŠ¸</button>
        </div>
        
        <h2>API URL</h2>
        <pre id="apiUrl">ëŒ€ê¸° ì¤‘...</pre>
        
        <h2>ì‘ë‹µ ìƒíƒœ</h2>
        <pre id="status">ëŒ€ê¸° ì¤‘...</pre>
        
        <h2>ì‘ë‹µ ë°ì´í„°</h2>
        <pre id="response">APIë¥¼ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ ìœ„ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</pre>
        
        <h2>ë°ì´í„° ìš”ì•½</h2>
        <pre id="summary">-</pre>
    </div>

    <script>
        const API_BASE = 'http://localhost:3006/api/v1';
        
        async function testAPI(endpoint) {
            const url = endpoint === 'models' || endpoint === 'pricing' 
                ? `${API_BASE}/${endpoint}?provider=openai`
                : `${API_BASE}/${endpoint}`;
            
            document.getElementById('apiUrl').textContent = url;
            document.getElementById('status').textContent = 'ìš”ì²­ ì¤‘...';
            document.getElementById('response').textContent = 'ë¡œë”© ì¤‘...';
            document.getElementById('summary').textContent = 'ë¶„ì„ ì¤‘...';
            
            const startTime = Date.now();
            
            try {
                console.log(`Fetching: ${url}`);
                const response = await fetch(url);
                const responseTime = Date.now() - startTime;
                
                const statusText = `âœ… ${response.status} ${response.statusText} (${responseTime}ms)`;
                document.getElementById('status').textContent = statusText;
                document.getElementById('status').className = 'success';
                
                const data = await response.json();
                console.log('Response data:', data);
                
                // ë°ì´í„° í‘œì‹œ
                document.getElementById('response').textContent = JSON.stringify(data, null, 2);
                
                // ìš”ì•½ ìƒì„±
                let summary = '';
                if (endpoint === 'models' && data.models) {
                    summary = `ì´ ${data.models.length}ê°œ ëª¨ë¸\n`;
                    summary += `ìºì‹œ: ${data.cached ? 'âœ…' : 'âŒ'}\n`;
                    summary += `ëª¨ë¸ ëª©ë¡:\n`;
                    data.models.forEach(m => {
                        summary += `  - ${m.name} (${m.slug})\n`;
                        summary += `    ì»¨í…ìŠ¤íŠ¸: ${m.contextWindow}, ê°€ê²©: $${m.pricing?.inputPerMillion || 'N/A'}/1M\n`;
                    });
                } else if (endpoint === 'pricing' && data.pricing) {
                    summary = `ì´ ${data.pricing.length}ê°œ ê°€ê²© ì •ë³´\n`;
                    data.pricing.forEach(p => {
                        summary += `  - ${p.model?.name || p.modelId}: $${p.inputPerMillion}/$${p.outputPerMillion}\n`;
                    });
                } else if (endpoint === 'status') {
                    summary = `ì´ ëª¨ë¸: ${data.totalModels}\n`;
                    summary += `í™œì„± ëª¨ë¸: ${data.activeModels}\n`;
                    summary += `í‰ê·  ê°€ìš©ì„±: ${data.avgAvailability}%\n`;
                } else if (endpoint === 'scheduler') {
                    summary = `ìŠ¤ì¼€ì¤„ëŸ¬ ìƒíƒœ: ${data.initialized ? 'âœ… í™œì„±' : 'âŒ ë¹„í™œì„±'}\n`;
                    if (data.tasks) {
                        summary += `ì‘ì—… ëª©ë¡:\n`;
                        data.tasks.forEach(t => {
                            summary += `  - ${t.name}: ${t.isActive ? 'âœ…' : 'âŒ'} (${t.schedule})\n`;
                        });
                    }
                }
                
                document.getElementById('summary').textContent = summary || 'ë°ì´í„° ìš”ì•½ ì—†ìŒ';
                
            } catch (error) {
                console.error('API Error:', error);
                document.getElementById('status').textContent = `âŒ ì˜¤ë¥˜: ${error.message}`;
                document.getElementById('status').className = 'error';
                document.getElementById('response').textContent = error.stack;
                document.getElementById('summary').textContent = 'ì˜¤ë¥˜ ë°œìƒ';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ëª¨ë¸ API ìë™ í…ŒìŠ¤íŠ¸
        window.addEventListener('load', () => {
            setTimeout(() => testAPI('models'), 500);
        });
    </script>
</body>
</html>